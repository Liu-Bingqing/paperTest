# 研究点2--跌倒行为识别判断
## ⭐调研收获和启发
### 摘要
潜提人工监控问题
### 绪论描述
传感器类 - 穿戴式、环境、智能手机或手表陀螺仪
智能家具物联网方法
计算机视觉 - 单动态目标跟踪 - **简单的在线实时跟踪方法(Simple Online and Realtime Tracking, SORT)**
家用监控设备优势：一套简单的室内监控系统只需要摄像头、存储硬盘和连接网络，家用监控摄像机分辨率要求不高，价格低廉
深度学习 - 智能安全监控硬件芯片算力低，参数较多的算法模型无法达到实时效率，同时普通人体姿态分类不能满足智能安全检测要求
#### 背景
老年人并不是唯一受姿态不稳定影响的对象，患有神经退化性疾病（如帕金森氏病（PD））及其他因脑血栓中风病人也会出现姿态不稳和跌倒现象
据统计[2]，2020年，全球65岁或以上的老年人口已达到7.27亿，到2050年可能达到15亿。2020年，该年龄段的老年人比例为9.3%，2050年将达到16.0%。跌倒最可能的后果是骨折，这会导致身体残疾，这会妨碍独立生活的能力，以及对再次摔倒的心理恐惧。跌倒不仅会对老年人造成中度或重度伤害，还会给他们及其亲属带来情感负担和经济压力。面对这种情况，快速有效地识别老年人跌倒尤为重要。一方面，它可以及时提醒监护人寻求帮助，以减轻跌倒造成的伤害；另一方面，它可以节省公共医疗资源，减轻社会公共医疗负担
[2]World Population Ageing 2020 Highlights-the United Nations. Available online: https://www.un.org/development/desa/pd/sites/www.un.org.development.desa.pd/filesundesa_pd-2020_world_population_ageing_highlights.pdf (accessed on 29
October 2021).
动作检测主要分为离线动作检测和在线动作检测。离线动作检测一次读取整个视频，然后定位整个视频中发生动作的时间。在线动作检测将连续读入新帧，并及时发现视频中的异常行为，因此预测速度要求实时。可见，在线动作检测更符合现实需求，本文将重点关注在线动作检测。
跌倒的发生是随机和不可预测的，不同时间和地点的外部环境影响可能导致跌倒的发生[18]。如果摔倒的人独自住在家里，很难被及时发现和治疗。
近年来，人口老龄化和少子化的趋势正在逐渐增加。人口老龄化已成为一个世界性的问题。随着年龄的增长，跌倒的风险随着身体机能的下降而增加。根据台湾行政院卫生署2000年的统计，65岁以上老年人的死亡率为16.5%（约为老年人口的1/6）。65岁人口的第二个死亡原因是跌倒，跌倒最常见的直接后果是骨折和其他长期疾病。长期疾病。跌倒不仅会对老年人造成伤害，还会造成身体伤害，如骨折或头部创伤，这会增加疾病的发生率和死亡率，并且经常伴随着再次跌倒的恐惧，从而导致自我限制，导致功能和行动能力逐渐丧失。快速有效地识别跌倒的老人并提供紧急援助尤为重要。
世界卫生组织最近的报告[1]显示，全球每年估计有684000人死于跌倒，3730万人跌倒严重到需要医疗护理。
1] “Falls.” [Online]. Available: https://www.who.int/news-room/fact-sheets/detail/falls
这些跌倒是与内在心理或身体健康、环境和老化问题相关的多因素问题，这些问题会导致不同的严重伤害、功能紊乱、短期/长期护理、残疾，甚至可能导致死亡。老年人跌倒的早期反应有助于降低受伤和死亡率，并减少相关的护理和治疗费用，从而减少严重后果。
跌倒检测是一种有效的保护策略，可以自动检测跌倒的发生，并及时采取干预措施（例如向护理人员发送通知，向救援队发出警报并通知亲属）。自动跌倒检测系统非常重要，它将为老年人创造舒适的生活，并确保更好的医疗保健。
近年来，随着中国老龄化人口数量有了上升的趋势，人口老龄化问题越来越经常出现在人们的视野当中，主要是因为我们国家的人口结构发生了很大的改变，老年人口比例逐年上升，而年轻人生育意愿低，导致新生人口比例逐年下滑，在可预见的将来，老龄人口的上升将会成为一种趋势，所以这个问题的解决变得尤为迫切，而跌倒事件作为威胁老年人身体健康的最大的风险之一，是这个热点问题的重点，正因如此，跌倒检测这个课题频繁出现在各大研究机构当中。越来越多的专家学者开始涉及老年人独居场景下的跌倒检测任务。
对于基于环境传感器的跌倒检测方法的缺点主要是受外界影响过大，还有就是成本过高，一般的家庭用户承担不起这个设备成本，另外，近年来对该方法的研究渐渐出现了日趋减少的现象。对于基于穿戴式设备的跌倒检测系统来说，在我们系统面向的老年人用户会对穿戴式设备产生抵触心理，因为多一个东西在身上难免会产生不适应，还有老年人记忆力不好，时常会忘记穿戴这种设备，所以就实际应用来说，穿戴式设备的推广还有很长路要走，而且目前可预测的方向还是往微型化，轻量化发展，如果设备条件没达到，穿戴式设备还不能成为此任务的首选
### 现阶段调研出的问题和难点
#### 难点和挑战
摄像机用于记录人体姿势序列，并根据不同的形状描述符对姿势进行分类。当前研究中进行的工作属于视觉姿态识别系统的后一类。尽管应用广泛，但由于人体部位的比例变化、相机视图变化、复杂场景、杂乱背景、阴影和反射、携带的物体、遮挡和高度类内变化、衣服的颜色和纹理不同、照明条件和执行率变化，人体姿势识别是一项具有**挑战**性的任务[49]。
⭐**仅通过单个帧中的有限特征来判断结果是不合理的**。更先进的方法，如序列和分解融合方法，首先基于空间特征提取构建特征向量，然后应用时间分析理论来提高其性能。其他研究介绍了使用空间和时间特征来构建瞬时融合特征向量。然而，寻找与人体异常跌倒密切相关的关键点，并在跌倒过程中的这些关键点建立时间和空间信息的耦合模型，是一项具有挑战性的任务。-**要从视频帧特征随时间序列变化分析**
**人体行为建模与识别难点** 
（1）复杂场景和监控**视角变化**问题：人类活动的空间场景是变化的，不定时地有物体出现或者消失，从而造成一些扰动。像光线等外部因素的改变，也会引入较多的噪声。另外，不同相机视角下的动作会使模型产生不同的行为特征。 
（2）动作类内差异性和类间相似性问题：相同动作的表现会因每个人的体型和习性而不同，以及同一动作在不同监控视角下都会有较大差异。人体动作与动作之间存在特别相似的地方，使得计算机难以判断，例如人突然躺在沙发上和跌倒有相似性。 
（3）模型表征能力不足问题：为了提取更深层的视觉特征，通过直接增加模型深度的方式增强表征能力，会出现梯度消失问题和过度拟合现象导致模型泛化能力降低。 
（4）序列建模的长期依赖性不足问题：由于有的动作持续时间较长，当进行序列建模时，难以构建长时间依赖关系从而导致上下文建模的不完整。
#### 问题
弱光和曝光场景下如何精确提取前景目标
（1）由于人体具有非刚性的特点，在日常生活中，人体姿态会呈现多样性，比如人体会呈现坐、站立、弯腰等各种姿态；不同天气、不同灯光下人体在摄像机下的影像特征也有不同；其它非人体运动（猫狗等）也会给目标检测带来干扰；因此面临的第一个关键问题是由于人体姿态多样性、光线变化、虚假目标干扰导致不同姿态人体目标检测精准率、召回率低的问题。
（2）居家老人在室内的行为活动常常伴有以下行为：正常行走、正常行走时摔倒、正常行走时弯腰、正常行走时下蹲、从座位上突然起身、行走时弯腰等；如果老人居住在别墅，还会出现在室内上下楼梯等行为，这些行为称为类跌倒行为，会严重混淆老人的跌倒检测；因此面临的第二个关键问题是由于人体行为动作复杂性导致跌倒与类跌倒的不易区分，导致误判的问题。
**特征选择是一个至关重要的步骤，因为分类精度很大程度上依赖于选择的特征。特征选择还减少了数据集容量和模式识别过程的成本。特征可以使用筛选方法或包装方法来选择**
##### 背景
传统的监控摄像机仅提供被动图像捕获、存储和回放功能，以记录事件的发生。当发生异常事件时，很难立即发出警告。特别是，传统的监测方法主要依靠人工。当长时间看多个监控屏幕积累的精神压力和疲劳会分散注意力，忽视事故的发生。因此，如果无处不在的摄像头能够与我们的智能监控技术相结合，将大大提高视频监控系统的价值。
##### 传感器
传感器的不足：穿戴式不方便，环境传感器对噪声敏感导致数据干扰较多加大信息提取工作，智能手机或智能手表陀螺仪对于老年人群并不流行类似于穿戴式传感器
基于可穿戴传感器的检测方法，使用加速计和陀螺仪来检测跌倒，长时间佩戴传感器会影响人们的生活舒适度，会增加老年人的身体负担，在从事复杂活动时，假阳性率更高。
##### 物联网+云端、智能家居+wifi
物联网的不足：成本较高且未普及，使用物联网云端方式存在隐私问题
连接wifi安装于地毯的压力传感器对于不同室内场所实施性和应用性较差且成本较高
基于场景传感器的方法使用安装在监控区域中的场景传感器来收集压力、振动和声音等信息，以确定是否发生了跌倒。然而，此类传感器对噪声信息敏感，容易出现误报[26，27]；此外，布置成本高且准确率低。
##### 深度学习
深度学习：计算机视觉在监控视频的分析研究需要较大算力的支持，而目前市面上的家用监控硬件芯片无法满足造成实时检测预警实时性低的问题，深度学习算法需要的数据过于庞大的问题
局限性：高计算复杂性，需要大量训练数据集
由于跌倒行为数据相较于正常人体姿态数据较少，因此基于深度学习算法的跌倒行为判断算法出现过拟合问题

一些深度学习算法的不足和挑战：由于当前大多数动作识别数据集不具有人体姿势的注释信息，因此当前基于骨架的动作识别算法的常用方法是使用姿势估计算法来预测姿势信息并将其保存在本地。然而，不能保证本地保存的方法的速度，并且不能保证使用新数据集上的其他数据集训练的姿势估计模型生成的姿势信息是准确的。另一种方法使用多任务方法来预测关节点并同时识别行为。然而，这将带来更多的参数，并且需要训练数据集中的姿势注释。

基于运动历史图像的人体姿态模板对硬件存储要求高，且实时性差
##### 姿态关节点提取
通过姿态作为特征模型的不足：人体姿势骨骼关键点判断时容易出现关键点重合或确实误判现象，并且跌倒姿势具有偶然性在训练阶段造成测试结果与训练结果误差较大的问题，基于关节点设计跌倒判断特征向量过于理想化，难以应用于具体现实场景中
一般方法都是目标检测识别、跟踪、姿态判断
##### 要求
需要在低能耗、低成本硬件平台快速、准确检测老人跌倒异常行为

### ⭐方法启发
我们提出了一种跌倒检测方法，该方法探索了视频序列的不同帧处可用的人体几何结构。特别地，姿势估计、由识别的面部图像的头部质心和身体的中心臀部形成的向量之间的角度和距离以及与中心臀部的水平轴对齐的向量被用于构建新的独特的图像特征。在新构造的特征图像上训练两类支持向量机（SVM）分类器和时间卷积网络（TCN）。同时，在计算的角度和距离序列上训练长短期记忆（LSTM）网络，以对跌倒和非跌倒活动进行分类。
#### 特征提取 特征分量
[24] Brown G.An accelerometer based fall detector:development,experimentation, and analysis.University of California Berkeley Ca,2005,1(1):1-9.
从目标速度出发，跌倒过程主要分为4个阶段：1.跌倒前失衡状态，目标在跌倒之前有一个先行动作，失去平衡后产生竖直偏差状态，但与正常目标状态差异极小不适合进行特征提取。2.跌倒前失重状态，目标从失衡状态开始到目标与地面接触状态，目标速度和加速度明显变化，倾斜增大处于自然下落状态，特征提取最佳状态。3.跌倒触底碰撞状态，目标与地面发生剧烈撞击，虽然速度和加速度变化不大但依旧保持跌倒速度特性，目标形变巨大，也可以提取有效特征信息。4.跌倒静止状态，辅助判断，基于最小外接矩阵+中心高度比、中心变化率特征进行分析

生活跌倒行为过程一般为：行走（站立/正常姿态）-> 跌倒过程 -> 跌倒状态
通过前景提取逐帧获取目标边框以实现视频动态目标检测，可以计算其宽高比，边框中心移动速率及移动矢量等转化为数学问题
人体姿势骨骼关键点判断时容易出现关键点重合或确实误判现象，并且跌倒姿势具有偶然性在训练阶段造成测试结果与训练结果误差较大的问题 - [人体的质心高度低于正常情况；颈部关键点的坐标小于下蹲时的最大高度；人体轮廓的最小外接矩形的宽高比小于一定值；大腿、小腿和上肢之间成一定的夹角；当人在公交车内身体向后跌倒时，手部与地面接触。]
共同点  身体重心瞬间下降，身体中轴线与水平线夹角瞬间减小 -> 整合为特征向量后传入分类算法
不同姿态跌倒行为检测
站姿、走 -> 跌倒
坐姿 -> 跌倒  关节点出现重叠
蹲
根据轮廓角判定坐姿、站姿、蹲、走等
时空卷积神经网络 - 目前使用时间图卷积是视频帧，空间图卷积是基于AlphaPose的关节点标注特征，现可以考虑时间图卷积不变，将空间图卷积的输入换成目标最小边框宽高比+重心变化线速度+中轴线与水平夹角特征向量
算法要轻量级
人体跌倒过程中，无论任何姿态的跌倒，头部中心点比其他部位（如腿、手臂等）有更明显的变化
**目标矩形宽高**：形状特征的几何参数可以有助于预测跌倒，因为当检测到跌倒时，身体的轮廓在特征形状上有非常明显的变化（Chen等人，2020）。通常，当个体站立或行走时，身体对称性可以呈现在直立位置，外部人体边界框具有明确的垂直矩形形状；当个体坐着时，上半身的对称性可能是弯曲的，并且外部的人体边界框可能倾向于呈正方形；当个体有跌倒的风险时，个体可能仰卧，这将导致水平矩形。因此，当个体移动时，宽高比有显著的变化。
**躯干角度**：是躯干与穿过身体重心（臀部）的垂直平面形成的角度。躯干控制是功能性步行步态平衡评估中的一个重要特征，因为它显示了躯干肌肉保持垂直或中性位置、承受体重和有选择地移动以将重心保持在支撑底座上方的能力。换言之，躯干角度与功能活动期间的躯干平衡有重要关系，并对跌倒概率有贡献（Karthikbabu等人，2011）。通常，当个体站立时，身体对称性将是直立的，通过重心的垂直线的角度将与肩部位置成大约0度；当个体行走时，角度值将在45度到90度之间；当个人摔倒时，角度将大于90度。
**连接一个人脖子和脚踝中心点的线的长度是一个有价值的参数**
使用最小关键帧判断实时跌倒行为，而非整个视频帧以减少算法复杂性以及资源算力和时间消耗
步态速度
正常跌倒和突然跌倒都需要检测，跌倒分为正常跌倒和突然跌倒，即自发跌倒或受外力影响跌倒，都存在安全隐患
**正常跌倒行为**当物体从直立姿势开始下落时，发生正常下落，瞬时速度逐渐增加，直到在短时间内达到空转速度。它也被称为低冲击跌落或软跌落。这里，瞬时速度是每个时间间隔两个相邻帧之间物体的位移。空转速度是指人在站立、行走、躺下或进行任何不需要他采取跌倒姿势的活动。**突然摔倒**发生在某人因路上的某种障碍物摔倒、在地板上滑倒、因姿势尴尬而失去平衡、癫痫发作[17、26、27、36]等情况下。在这种情况下，摔倒的人几乎没有任何抵抗力来阻止自己，这会导致突然快速摔倒，这可能是致命的。当物体突然从直立姿势开始下落，瞬间速度增加，直到在很短的时间内达到空转速度时，就会发生突然下落。它也被称为高冲击跌落或硬跌落。
**瞬时速度：突然下降>正常下降；正常跌倒>>像ADL一样跌倒；突然摔倒>>像ADL一样摔倒。**
**夹角**
坐着或站着/非跌倒姿势：头部和重心臀部的向量和水平轴的夹角几乎垂直或夹角小于45°
跌倒：头部与重心臀部的向量几乎和水平轴齐平
本文将乘客两髋中心点（SpineBase）距离地面的高度d和人体中心点（SpineMid）下降的运动速度v作为两种判定条件
为了降低误判率，需要引入有效面积比的特征来补充识别，提高坠落检测的准确性。**有效面积比(EA-ratio)**定义为人体所占像元面积与最小外部矩阵所占像元面积之比。
#### 特征分析 分类算法
基于时间特征的神经模糊推理系统
**特征融合、决策融合**
**椭圆拟合**
识别面部图像的头部质心、身体中心臀部形成的向量与中心臀部水平轴对齐的向量之间的角度信息
## 专业缩写
Activities of Daily Living (ADL) 
An Active and Healthy Ageing (AHA)积极健康的老龄化
Human Behavior detection - HBD
Internet of Things (IoT)
Human Action Recognition (HAR) 人类行为识别
Fall Detection System FDS 跌倒检测系统
Context Aware Systems (CAS) 上下文感知系统
Region of Interest (RoI) 感兴趣区域、
Motion History Images (MHI) 运动历史图像
## 人为判断

## 基于 可穿戴式硬件装置 技术
主要设备：陀螺仪、重力感应器、关节传感器等
优势：判断实时性较高
缺点：对于老年人不友好，携带不便；传感器精准度有时候会产生较大误差，出现误判问题
近几年研究使用智能手表陀螺仪和物联网技术进行跌倒警报
老年人经常忘记佩戴传感器。可听见的传感器捕捉异常值，如速度和角度，并向用户发送警报。可佩戴传感器需要频繁充电，这会使老年人难以持续监测电池充电状态。可佩戴传感器也不太舒适。由于传感器的频繁充电、不适和其他副作用，此选项不太适合老年人。
## 基于 YOLOv7 技术 - 目标识别
优势：优化训练过程，重点放在优化模块和方法，提升目标检测准确性，动态标签分配技术实现模型重参数化，从粗粒度到细粒度的引导式标签分配
缺点：训练过程耗时大，且计算资源要求高
## 基于 骨架数据集 分类肢体目标跟踪

## 基于监控视频的跌倒检测系统
优势：设备成本低、实时性强

## 考虑点：监控设备隐私性


## cv background