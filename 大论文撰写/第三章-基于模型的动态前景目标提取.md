# 第三章-三 基于**模型的动态前景提取
监控视频数据由多张单帧图像组成，在短时段内随时间帧改变图像内容的图像序列数据，当连续变化的单帧图像帧率超过每秒24帧时，人眼因视觉暂留将无法辨别单幅静态画面以达到平滑连续视觉效果[27]。同时，监控视频中单帧图像之间具有较多动态关联性信息，对监控视频数据的研究实际上是对视频内连续单帧图像关联性和动态目标变化规律的研究分析。运动前景目标的识别和提取主要对视频帧图像中动态变化区域进行判定和提取[28-29]。监控视频存在大量背景信息和干扰信息，对关键目标和感兴趣目标的研究带来较多冗余特征信息，从而极大降低对动态人体目标的行为特征研究。因此，在行为研究和跌倒识别过程中需要进行视频动态前景目标的提取。
## 3.1 主流动态目标提取算法
（与模型相关的动态前景提取方法）说明动动态前景目标模型使用场景，理论基础以及动态前景目标模型的大致流程

本文的跌倒行为检测的目标对象是室内单目监控视频中的动态人体，首先需要针对监控视频数据中的动态人体进行动态前景提取，通常动态前景目标提取的流程图如下：
视频分割图像 -> 图像预处理 -> 建立模型 -> 动态前景目标提取 （待定）【动态目标提取流程图】
根据本文研究场景的特点，目前基于计算机视觉技术主流的监控视频动态前景目标提取算法分别有帧差法、光流法和背景减法。
### 3.1.1 帧差法
（相关原理）

帧差法(Frame Difference)【30-31】是较容易实现的视频动态目标提取算法，该方法根据视频连续帧间图像具有强关联性特点进行帧间差分提取帧间差异动态特征信息的过程。若监控视频中视频图像序列无运动变化信息或帧间目标变化不明显则基于帧差法提取的动态前景目标结果不明显，否则可以识别视频中动态前景目标区域。帧差法将图像间差异变化处理转化为数学公式差分运算，通过设定单一固定阈值对差分结果绝对值进行动态前景目标和静态背景区域划分。
假设监控视频数据在预处理阶段总共被分割为n张单帧图像(f^N=1,2,......,n)，对连续两帧图像间的灰度像素值进行差分运算，得到差分图像D^n，如公式():
【公式()】
其中(x,y)是图像像素点位置，f^n(x,y)和f^n-1(x,y)分别表示第n帧图像和第n-1帧图像的像素灰度值。然后设置固定阈值T分类分割差分图像D^n中的动态前景目标和静态背景区域，同时对分割结果进行图像二值化处理操作以强化视频动态前景区域效果。如公式():
【公式()】
其中，R^n(x,y)结果中的255像素值区域是帧差法判别为视频动态前景目标区域，0像素值区域是帧差法判别为视频静态背景区域。最后对动态前景目标区域进行连通性分析获得基于帧差法的视频中动态前景目标提取结果。
二帧差分方法一般适用于动态目标运动慢的视频场景，为应对运动速度快的视频研究者增加单帧图像差分来缩小大幅运动目标的时间间隔目标图像差距。【李秋林】【32】等人提出三帧差法进行视频中动态车辆目标检测，他们分别对连续三帧图像进行灰度值差分，然后对差分图像做交处理，最后使用固定阈值分割前背景区域，该方法可以检测到不同行驶速度的车辆信息。【张彩珍】【33】等人提出一种五帧差分与模板匹配融合方法，结合Harris算法提取像素特征值作为角点匹配提升差分准确性。多帧差分法提升在二帧差法上做出改进，使得算法可以在不同运动速度目标的视频场景中检测到动态目标，增加了帧差法的鲁棒性。多帧差分法的基本结构图如下：
【多帧差分算法结构图】
本文研究对象跌倒行为过程运动速度快且时间较短，
综上所述，帧差法原理相对简单、容易实现且可以快速检测提取视频中的动态目标。但是，帧差法对于运动迅速的目标提取效果较好额，而对于帧间运动目标变化小导致连续多帧目标位置重叠现象，差分结果绝对值一般被判定为背景区域从而出现“空洞”问题。因此，在监控视频动态目标提取过程中，需要对帧差法进行改进以及算法融合的方法提升基于帧差法的动态前景目标提取的完整性。

【⭐⭐如果在运动目标检测中使用帧间差分法，那么阈值的选取至关重要。阈值取值过小就没办法降低图像中噪声的影响；取值过大则会隐藏差分图像中运动目标的部分信息。如果将阈值设为固定值，则目标检测的结果极易受到场景中光线变化的影响。】
### 3.1.2 光流法
（相关原理）

光流法的物理概念是指空间内运动物体在成像上像素运动的瞬时速度【34】。人眼观察三维空间运动物体时，视网膜上产生一系列连续图像，类似于光线在视网膜上“流”过，被称为光流【35】。监控摄像机设备模拟视网膜原理，三维动态目标在二维空间运动成像原理图如图()
【图() 光流成像图】
三维动态过程投射到二维平面的运动场，其对应的视频图像序列就是光流场，在光流场中t时间间隔中像素点的灰度值为I(x,y,t)，利用连续时间间隔内的图像序列具有关联性计算像素点运动特征信息。
光流算法将三维运动目标转换为二维x,y轴两个分量的位移矢量：【】，通过堆叠水平分量和垂直分量表示t时间间隔内的光流场运动方向和速度[36]，假设该像素点在t时间间隔运动距离为(dx,dy)到视频下一帧图像，则在视频光照强度一致和三维空间不变的前提下，像素点灰度值变化在二维空间的投影如公式()
【公式()】
对上述公式进行泰勒展开得到公式()
【公式()】
结合公式()和公式()可得到公式()
【公式()】
为了简化公式，令【I^x=】，因此光流法算法公式如下：
【公式()】
从上述理论公式推导可以看出光流法通过分析光流场中像素点运动速度和方向获取三维视频中运动目标的位置变化信息，从而检测视频动态目标。
综上所述，虽然光流法对静态背景变化具有较强的抗干扰性，但是光流法抗噪效果差。光流法计算复杂度相较于帧差法较高，提高动态目标识别的耗时，并且对现实场景中光照变化非常敏感。场景视角改变和研究场景空间变化都会对基于光流法的视频动态目标提取结果造成影响。
### 3.1.3 背景减法
(相关理论)

背景减法的原理与帧差法类似【37】，首先选取无动态目标的背景图片用于构建背景模型，再读取视频中出现动态目标的当前单帧图像与背景模型进行差分处理操作，然后通过提取设置的固定阈值进行差分图像像素值判别，如果差分图像像素值大于阈值则算法判定该像素点发生位移，即为视频动态目标相关像素点，否则检测为静态背景并重新更新背景模型。最后，算法需要对阈值过滤后的判定结果进行二值化处理。基于背景减法的视频动态目标检测流程图如下图()
【图() 基于背景减法的视频动态目标检测流程图】
假设视频在预处理过程中被划分为N张单帧图像(N=1,2,......,n)，则背景减法中差分操作与帧差法一致如公式()，但背景模型是无动态目标的完全静态背景区域的存储图像集。
【公式()】
其中(x,y)是视频单帧图像的像素点位置，A^n(x,y)表示视频中第n帧图像，B^n(x,y)表示背景模型中第n帧背景图像。D^n(x,y)表示当前视频图像与背景图像差分的像素值。设置固定阈值T分割差分图像并对动态前景区域和静态背景区域进行判别结果二值化处理，如公式()。
【公式()】
为了进一步增加背景减法的视频动态目标完整性，【司海飞】等人【38】提出一种改进背景减法提取监控视频中动态前景目标轮廓，再进一步对目标外轮廓进行分析研究。他们提出一种最佳阈值法代替背景减法差分图像分割的固定阈值，进一步增加算法对动态前景目标提取的精准性。【Haifei Si】等人【39】提出一种仅检测跌倒行为的背景减法，他们通过分析实验场景下运动目标外边距以及重心变化将背景减法固定阈值设定为跌倒行为临界阈值从而判别视频中跌倒行为目标。
综上所述，背景模型构建和背景更新操作是直接影响背景减法对视频动态前景目标检测提取的关键步骤，背景减法仅适用于背景不变的实验场景，但是在本文研究场景中，实际室内监控场景存在光照变化、目标遮挡、跌倒行为运动过程时间短等诸多因素的影响，基于背景减法的视频动态前景目标算法对快速运动目标检测完整性和精准性低。同时，背景减法需要相同视角下静态背景视频数据和该场景下运动视频数据作为算法的输入数据，因此背景减法相较于帧差法要求硬件算力和算法耗时更高。
### 3.1.4 视频动态目标检测算法对比
根据上述视频动态目标检测算法的介绍，从算法性能进行对比如下表():
【表() 视频动态目标检测算法对比】
## 3.2 问题与挑战
（描述上述方法的特点和不足，动态前景目标提取方法的难点和挑战等）
在生活中，室内单目监控视频场景存在干扰因素会降低动态目标分析
室内单目监控视频具有更多的干扰源，例如照明变化，设备抖动及家居遮挡等问题
## 3.3 本文方法
### 3.3.1 模型整体设计
（模型整体设计和流程）


### 3.3.2 数据预处理
### 3.3.3 模型
## 3.4 实验与结果分析
### 3.4.1 对比实验与分析
## 3.5 本章小结

