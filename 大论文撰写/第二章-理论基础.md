# 第二章- 二 室内单目监控视频场景跌倒检测分析与设计
## 2.1 人体行为检测理论基础【可以放在特征提取中】
**可以放在第4章，跌倒特点分析**
跌倒行为检测是人体行为检测研究领域的热点研究方向之一，人体行为检测是医疗领域和监控安全领域中重要的研究方向之一。在日常生活中，人体行为主要分为正常活动行为、类跌倒行为和跌倒行为。正常行为活动主要包括站立、行走、奔跑、坐着、躺着等。类跌倒行为主要包括坐下、蹲下、弯腰、躺下等动态变化姿态。与正常行为相比，跌倒行为过程的动作幅度和速度更剧烈且在短时间完成整个行为过程，具有突发性，其最显著的特点是在一瞬间人体目标的速度和加速度从零升至峰值再归零的变化。类跌倒行为与跌倒行为有相似之处，存在姿势的改变和躯干竖直位移且人体重心在短时间内发生明显位移，因此如何区分日常生活中类跌倒行为和跌倒行为是人体跌倒行为判断的难点之一。

（跌倒行为三个阶段的对比  进行特征提取 的表格
对不同人体信息  根据特征信息进行不同的分类）

## 2.2 场景定义与跌倒行为分析
### 2.2.1 室内单目监控视频场景定义
理想状态下实验室场景被称为简单场景，其特点是背景基本无明显变化、实验环境较稳定且无光影和动态背景干扰、人物目标行为单一。在简单场景下的目标提取和跌倒识别精准度一般较高，但简单场景规避掉许多现实场景中的无法避免的现象，例如室内光影变化导致动态阴影干扰，设备噪声以及家庭家居遮挡人体目标问题等。近几年，许多研究人员对复杂场景视频进行更深入的分析研究以提升模型在实际应用性。为了进一步提升本文模型的实用性和鲁棒性，本文的研究场景基于室内场景和监控设备的真实情况选择实验数据，包含运动非目标的物体、变化的背景，遮挡目标和噪声鬼影干扰等室内复杂监控视频数据。人体行为检测视频数据分为RGB数据、RGB-D数据及多视角视频数据。RGB-D数据在三通道图像数据基础上增加深度通道，为跌倒检测模型提供更多的特征信息但增加模型的耗时和算力执行要求。多视角视频数据一般应用于根据三维人体模型检测跌倒行为的模型中，其在跌倒特征信息提取方面需要较多处理和独特性，且居家监控设备不会使用多视角监控单独目标。本文根据家用监控视频设备普遍使用特点，仅使用单目RGB三通道室内监控视频数据信息实现基于计算机视觉的跌倒行为检测。与人体行为检测类似，跌倒行为检测过程主要分为动态目标检测、跌倒行为特征提取和跌倒行为判断三个主要过程，本文从跌倒检测实现过程进行分析研究。动态前景目标提取作为跌倒行为检测的第一步，可以有效减少背景和其他干扰源无效特征信息的干扰，有效提升跌倒行为检测模型的识别准确性。特征提取是人体行为检测的重要步骤之一，通过分析跌倒行为与其他人体行为的差异与特点可以高效提取跌倒行为特征信息，根据跌倒行为特征信息可以有效判断不同视频数据中的跌倒行为。同时，随着社会发展人们逐渐重视隐私保护，因此要在监控视频隐私保护的基础上进行跌倒行为特征信息提取。跌倒行为可以归为分类问题，将特征信息作为检测标签输入跌倒检测模型对视频人体行为进行分类判别，并根据前景人体目标运动趋势进行跌倒预测报警以达到实时跌倒监测和预判的目标。
本文通过分析实验数据中不同情况下的跌倒行为和非跌倒行为，可以将跌倒过程分为三个阶段：跌倒前、跌倒过程、跌倒后
1. 跌倒前阶段：人体目标行为与正常人体行为相同，通常为行走、站立、坐着等情况，形体稳定甚至有时呈静止状态，如果一直该状态则可以判定为人体正常行为（Activity of daily life, ADL）。本文将跌倒前行为分为直立型跌倒前行为和坐蹲式跌倒前行为。
2. 跌倒过程阶段：人体动态行为变化最大，速度与加速度变化最明显的阶段，是跌倒判断过程中重要检测依据。在跌倒过程中，当人体目标处于直立型跌倒时，可能因直立滑倒或绊倒造成身体失衡出现倾倒。当人体目标处于坐蹲式时，可能因昏厥或抽搐导致人体前倾产生。当人体无法控制身体倾斜速度和角度时，身体进入跌倒下落过程，此过程中加速度和速度变化巨大达到峰值伴随头部、躯干、脚部变化。如何判断跌倒行为的开始是跌倒行为预测的难点之一。
3. 跌倒后阶段：人体目标下落后撞击地面产生大量形变，对人体目标造成不定量伤害。特别是老年人群体在跌倒后往往出现躺姿状态，并持续一定时间。若人体目标在经过明显加速度和速度变化后久躺不起可以判定为跌倒后昏迷进行报警。
### 2.2.2 跌倒行为定义【删除】
根据医学、物理学等进行跌倒行为定义与判断
## 2.3 场景数据集设计 【后续进行补充】
（按照数据集进行分类分节介绍，包含动态前景目标检测数据集、目标检测特征提取数据集和跌倒行为判断预测数据集。实验使用的所有数据集进行介绍）
通过对室内单目监控视频场景下的分析，本文根据跌倒行为检测的特点及数据需求设计实验数据集以验证和提升跌倒检测模型效果。
### 2.3.1 URFD 数据集
URFD数据集[]是由30个人体跌倒行为和40个人体正常活动行为的RGB视频序列组成，其中跌倒视频中包含直立型跌倒和坐蹲式跌倒情况，符合本文对跌倒行为判断研究划分。在本文实验中，使用【】正常行为视频和【】跌倒视频作为视频前景动态目标提取模型的实验数据，覆盖人体正常行为、类跌倒行为和跌倒行为三种人体行为类别。该实验数据为单人室内监控视频，【】的分辨率，跌倒行为占完整视频比重大有利于对跌倒行为进行特征提取与分析。
【URFD数据集[ 27 ]由30个摔倒的短视频序列和40个日常生活活动序列组成。使用两台Microsoft Kinect相机记录跌倒序列。在我们的实验中，使用了40个视频，共6834帧。这些框架分为行走、站立、躺卧、坐立、上移、下移和蹲伏7类。本文方法的特征向量长度为6384 × 21。从图10可以看出，所提出的方法优于现有的方法，包括
 Fo，de，Deky，Osu，Wm [ 43 ]和dl [ 31 ]。由于该数据集的类内差异较小，Kf表现更好。该数据集包含持续时间较短的人体姿势序列。】
数据集组成、特点、用途  主要用于前景动态目标提取实验中作为验证模型性能数据
### 2.3.2 CDnet 2014数据集
数据集组成、特点、用途 该数据集包含多种场景的监控视频，具有groud-touch验证数据，该数据用于对比实验数据以验证模型可以在不同室内复杂场景下进行动态前景目标检测。
### 2.3.3 NTU数据集
NTC数据集是由Kinect v2摄像机拍摄的室内监控视频，通过交叉主题和交叉视图产生的一组具有丰富行为姿态、多肢体样本的数据集，是姿态行为研究、面部表情研究和关节姿势评估的重要数据集之一。本文选择该数据集中的弯腰姿态数据和坐下姿态数据作为类跌倒行为数据和跌倒行为数据作为构成基于室内监控视频跌倒行为检测的实验样本数据，分别由【948】项和【4506】项。
### 2.3.4 
【LiveLab Labs为全方位技术的数据收集提供了一个类似家庭的环境。LiveLab提供了两个数据集，包括PLIA1和PLIA2。PLIA1是允许进一步了解行为的数据集合。
PLIA2包括4小时的视频数据（红外和RGB），其中制定了共享家庭活动的主题。
INRIA圣诞节包含11个动作，每个动作有10名演员（即5名男性和5名女性）三次。每个动作仅由一名演员执行。
tum厨房数据集提供了低级厨房场景中的图像。表7中报告了一些用于行为检测的视频数据集的详细信息。】
【Fall Detection Dataset(FDD)数据集[68]是于2012年被Charfi等人构建的一个开放跌倒数据集。该数据集包含了四个不同室内场景，其标签分别为Home、Coffee Room、Office、Lecture Room。多个不同的参与者在各个场景下演示了不同行为，包括各种跌倒行为、做家务、坐下、躺下等。由于场景不同，摄像头的方位和离目标对象的距离也不一样，获取到的视频也存在
不同程度的差异。在这个数据集中，视频的分辨率为320240。图2.6显示了该数据集中部分视频截图。 
 本章小】

## 2.4 跌倒检测模型评估指标
跌倒行为判断实质是基于计算机视觉的分类问题，本文研究的最终目的是对室内监控视频动态目标跌倒行为的判断和预估，因此需要建立对模型是否能准确判断动态目标跌倒行为的评价指标。同时，检测过程的总体耗时和检测速率是验证跌倒行为检测模型实时性的重要评估指标之一。本文使用目前基于计算机视觉的跌倒检测的通用指标准确度、精准度、F1指数和检测速率作为模型评估指标。公式如下：

其中TP FP FN TN是分类算法中的四种结果。【假阴性(FN) 发生跌倒，错误判定为未跌倒行为 假阳性(FP) 未发生跌倒，错误判定为跌倒行为 真阴性(TN) 未发生跌倒，正确判定为未跌倒行为 真阳性(TP) 发生跌倒，正确判定为跌倒行为 】
【其中，A（准确率）表示正确判别出实验中全部的跌倒行为和未跌倒行为的比率，F（误报率）表示未发生跌倒行为时，将未跌倒行为错误判别为跌倒行为的比率，M（漏报率）表示发生跌倒行为时，未能正确检测到跌倒行为的比率，即漏报比率，P（特异度）表示未发生跌倒行为时，能正确检测到人体正常行为活动的比率，S（灵敏度）表示发生跌倒行为时，能正确检测到跌倒行为的比率。 】
【一般基于计算机视觉的跌倒检测在分类时会有以下四种结果： （1）真正例TP，表示实际为跌倒且被检测为跌倒的样本。 （2）假正例FP，表示实际未跌倒却被检测为跌倒的样本。 （3）假反例FN，表示实际为跌倒却被检测未跌倒的样本。 （4）真反例TN，表示实际未跌倒且被检测未跌倒的样本。 
根据以上提到的参数，本文将采用以下五个指标作为判断跌倒检测算法优劣的标准：
准确度（Accuracy）表示模型正确分类的样本占总样本的比重，公式如下： 
精准度（Precision）是正确检测到的跌倒占所有检测为跌倒的行为中的比例，公式如下：
灵敏度/召回率（Sensitivity/recall）是正确检测到的跌倒在所有真实跌倒中的比例，公式如下：
F1指数结合了精准度和灵敏度的优点，综合衡量了跌倒分类器的好坏，公式如下：
帧率（FPS），即一段视频每秒钟处理的帧数，主要用来衡量系统的检测速度，从而满足实时性要求。 
】

## 2.5 本章小结
本文介绍了人体行为识别和跌倒行为判断的理论基础，对跌倒判断过程中的问题进行分析。提出简单场景下进行跌倒行为检测的不足并阐明室内单目监控视频场景特点及意义。根据场景特点和跌倒检测研究目标设计了研究和实验数据集和模型评估的指标。为后续模型设计、定义和实现提供场景和数据基础。